"use strict";(self.webpackChunkfailurebase_client=self.webpackChunkfailurebase_client||[]).push([[118],{2582:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var l=n(4942),i=n(1413),r=n(4925),s=n(9142),a=n(3433),o=n(9439),c=n(2791),d=n(7689),u=n(1087),f=n(4447),h=n(3223),m=n(7940),p=n(8390),g=n(1944),x=n(5687),v=n(8430),j=n(5265),Z=n(9489),k=n(9141),b=n(9672),S=n(4165),C=n(5861),y=n(5301),N=function(){var e=(0,C.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Z)("/api/tests",t.toString());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,C.Z)((0,S.Z)().mark((function e(t){var n;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",body:JSON.stringify({ids:t})},e.next=3,(0,y.Z)("/api/tests/delete","",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_={getAll:N,deleteGiven:D},w=n(2278),A=n(8030),P=n(3934),T=n(184),E=[{id:"uid-collumn",label:"UID",order:p.K.ASC},{id:"file-collumn",label:"File",order:p.K.DESC},{id:"total-events-count-collumn",label:"Events Count",order:p.K.ASC},{id:"marks-collumn",label:"Marks",order:p.K.NULL}],F=function(){var e,t=(0,d.s0)(),n=(0,m.$)(),S=n.setLoading,C=n.selectedTests,y=n.setSelectedTests,N=(0,u.lr)(),D=(0,o.Z)(N,2),F=D[0],M=D[1],O=(0,c.useState)({}),I=(0,o.Z)(O,2),K=I[0],q=I[1],G=(0,c.useState)(0),L=(0,o.Z)(G,2),U=L[0],$=L[1],V=(0,c.useState)([]),B=(0,o.Z)(V,2),H=B[0],J=B[1],R=(0,c.useState)(0),z=(0,o.Z)(R,2),Q=z[0],W=z[1],X=(0,c.useState)(!1),Y=(0,o.Z)(X,2),ee=Y[0],te=Y[1],ne=(0,c.useState)(!1),le=(0,o.Z)(ne,2),ie=le[0],re=le[1],se=(0,c.useState)(0),ae=(0,o.Z)(se,2),oe=ae[0],ce=ae[1],de=(0,c.useState)(0),ue=(0,o.Z)(de,2),fe=ue[0],he=ue[1],me=(0,c.useState)(!1),pe=(0,o.Z)(me,2),ge=pe[0],xe=pe[1],ve=(0,c.useState)(""),je=(0,o.Z)(ve,2),Ze=je[0],ke=je[1],be=function(){S(!0),_.getAll(F).then((function(e){var t=e.items.map((function(e){return function(e){return{id:e.id.toString(),data:[{id:"uid",label:(0,P.Dy)(e.uid,100)},{id:"file",label:(0,P.Dy)(e.file,100)},{id:"total_events_count",label:e.total_events_count.toString()},{id:"test-marks",label:e.marks.join(", ")}]}}(e)})),n=document.querySelectorAll("#filter-modal input"),l={};n.forEach((function(e){var t,n=null!==(t=e.id.split("-").slice(1,-1).join("_"))&&void 0!==t?t:"",i=F.getAll(n);i.length>0&&(n.includes("timestamp")?l[n]=(0,P.d$)(new Date(i[0])):n.includes("mark")?l.marks=i:l[n]=i[0])}));var i=0!==C.length&&t.filter((function(e){return C.includes(e.id)})).length===t.length;J(t),W(e.page_number),re(e.prev_page),te(e.next_page),ce(e.count),he(e.page_limit),xe(i),q(l),S(!1)})).catch((function(e){console.log(e),S(!1)}))};(0,c.useEffect)(be,[window.location.href]),(0,c.useEffect)((function(){$(Object.keys(K).length)}),[K]);var Se=function(e){var t=e.target.id.split("-").slice(1,-1).join("_"),n=t.includes("timestamp")?(0,P.d$)(new Date(e.target.value)):e.target.value;if(""===e.target.value&&t in K){K[t];var a=(0,r.Z)(K,[t].map(s.Z));q(a)}else q((0,i.Z)((0,i.Z)({},K),{},(0,l.Z)({},t,n)))},Ce=function(e){if("marks"in K){var t=(0,i.Z)({},K);t.marks=K.marks.filter((function(t){var n;return t!==(null===(n=e.currentTarget.parentNode)||void 0===n?void 0:n.textContent)})),q(t)}};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"filters",children:[(0,T.jsx)("div",{className:"row",children:(0,T.jsxs)("div",{className:"col filter-button",children:[(0,T.jsx)("span",{className:"brand",children:"Tests"}),(0,T.jsxs)(g.Z,{onClick:function(e){(0,v.h7)("filter-modal"),document.querySelectorAll("#filter-modal input").forEach((function(e){var t,n=null!==(t=F.get(e.id.split("-").slice(1,-1).join("_")))&&void 0!==t?t:"";""!==n&&(e.id.includes("timestamp")?e.value=(0,P.d$)(new Date(n)):e.id.includes("mark")?e.value="":e.value=n)}))},children:[(0,T.jsx)("img",{src:f.Z,alt:"Filter SVG"}),U>0&&(0,T.jsx)(x.Z,{text:U})]}),(0,T.jsx)(g.Z,{onClick:function(e){(0,v.h7)("delete-modal")},children:(0,T.jsx)("img",{src:h.Z,alt:"Delete SVG"})})]})}),(0,T.jsxs)(v.ZP,{id:"filter-modal",children:[(0,T.jsx)(j.Z,{children:(0,T.jsx)("span",{className:"text-primary",children:"Filter tests"})}),(0,T.jsxs)(Z.Z,{children:[(0,T.jsxs)("p",{children:[(0,T.jsx)("label",{htmlFor:"filter-uid-input",children:"UID"}),(0,T.jsx)("input",{id:"filter-uid-input",type:"text",placeholder:"Type phrase to search",onChange:Se})]}),(0,T.jsxs)("p",{children:[(0,T.jsx)("label",{htmlFor:"filter-file-input",children:"File"}),(0,T.jsx)("input",{id:"filter-file-input",type:"text",placeholder:"Type phrase to search",onChange:Se})]}),(0,T.jsxs)("p",{children:[(0,T.jsx)("label",{htmlFor:"filter-mark-input",children:"Mark"}),(0,T.jsxs)("span",{className:"grouped",children:[(0,T.jsx)("input",{id:"filter-mark-input",type:"text",placeholder:"Type mark to search"}),(0,T.jsx)("button",{id:"addMark",className:"button",onClick:function(e){var t=document.querySelector("#filter-mark-input");if(null!==t){var n,l=(0,i.Z)({},K);if(""!==t.value&&(void 0===l.marks||-1===l.marks.indexOf(t.value)))l.marks=[].concat((0,a.Z)(null!==(n=l.marks)&&void 0!==n?n:[]),[t.value]);t.value="",q(l)}},children:"Add"})]}),(0,T.jsx)("span",{children:null===K||void 0===K||null===(e=K.marks)||void 0===e?void 0:e.map((function(e,t){return(0,T.jsx)(A.Z,{text:e,onClose:Ce},t)}))})]})]}),(0,T.jsxs)(k.Z,{children:[(0,T.jsx)("button",{className:"button primary",onClick:function(e){for(var t=0,n=Object.entries(K);t<n.length;t++){var l=(0,o.Z)(n[t],2),i=l[0],r=l[1];if("marks"===i){F.delete("mark");for(var s=0;s<r.length;s++)F.append("mark",String(r[s]))}else F.set(i,String(r))}F.delete("page"),M(F),y([]),xe(!1),(0,v.Mr)("filter-modal")},children:"Submit"}),(0,T.jsx)("button",{className:"button",onClick:function(e){document.querySelectorAll("#filter-modal input").forEach((function(e){e.value="",F.delete(e.id.split("-").slice(1,-1).join("_"))})),q({}),M(F)},children:"Clear"}),(0,T.jsx)("button",{className:"button",onClick:function(e){(0,v.Mr)("filter-modal")},children:"Close"})]})]}),(0,T.jsxs)(v.ZP,{id:"delete-modal",children:[(0,T.jsx)(j.Z,{children:(0,T.jsx)("span",{className:"text-primary",children:"Delete tests"})}),(0,T.jsxs)(Z.Z,{children:[0===C.length?(0,T.jsx)("strong",{children:"No tests selected to deletion."}):1===C.length?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("strong",{children:"1 test selected to deletion. "}),"Do you confirm deletion?"]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("strong",{children:[C.length," tests selected to deletion. "]}),"Do you confirm deletion?"]}),(0,T.jsxs)(b.ZP,{id:"deletion-in-progress",children:[(0,T.jsx)("div",{style:{marginBottom:"10px"},children:(0,T.jsx)("span",{children:"Deleting..."})}),(0,T.jsx)(w.Z,{})]}),(0,T.jsxs)(b.ZP,{id:"deletion-done",children:[(0,T.jsx)("span",{className:"text-primary",children:"Result:"}),(0,T.jsx)("br",{}),(0,T.jsx)("span",{dangerouslySetInnerHTML:{__html:Ze}})]})]}),(0,T.jsxs)(k.Z,{children:[(0,T.jsx)("button",{className:"button primary",onClick:function(e){0!==C.length&&((0,b.Kc)("deletion-in-progress"),_.deleteGiven(C).then((function(e){var t=[],n=[];e.statuses.forEach((function(e){200===e.status?t.push(String(e.id)):n.push(String(e.id))}));var l=0===n.length?"All tests deleted successfully":"".concat(t.length," tests deleted successfully, the rest no longer exist in database.");ke(l),y([]),setTimeout((function(){(0,b.Ov)("deletion-in-progress"),(0,b.Kc)("deletion-done")}),1e3)})).catch((function(e){var t,n;ke("Deletion error"),setTimeout((function(){(0,b.Ov)("deletion-in-progress"),(0,b.Kc)("deletion-done")}),1e3),console.log("Error details: ".concat(String(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.detail)&&void 0!==t?t:"no details ")))})))},children:"Confirm"}),(0,T.jsx)("button",{className:"button",onClick:function(e){ke(""),(0,b.Ov)("deletion-done"),(0,v.Mr)("delete-modal"),""!==Ze&&be()},children:"Close"})]})]}),(0,T.jsxs)(v.ZP,{id:"unselect-modal",children:[(0,T.jsx)(j.Z,{children:"Unselect items"}),(0,T.jsx)(Z.Z,{children:"Do you confirm unselection of all items?"}),(0,T.jsxs)(k.Z,{children:[(0,T.jsx)("button",{className:"button primary",onClick:function(e){xe(!1),y([]),(0,v.Mr)("unselect-modal")},children:"Confirm"}),(0,T.jsx)("button",{className:"button",onClick:function(e){(0,v.Mr)("unselect-modal")},children:"Close"})]})]})]}),(0,T.jsx)(p.Z,{header:E,data:H,selectedItemsInfo:0===C.length?"":1===C.length?"1 row selected":"".concat(C.length," rows selected"),pageInfo:"page ".concat(Q+1," of ").concat(0!==oe?Math.ceil(oe/fe):1),secectedItems:C,selectAllChecked:ge,prevPageDisabled:!ie,nextPageDisabled:!ee,onSortClick:function(e,n){var l=e.replace("-collumn","").replaceAll("-","_"),i="".concat(n===p.K.DESC?"-":"").concat(l);F.set("ordering",i),M(F),t({pathname:"/tests",search:"?"+String(F)})},onSelectAllChange:function(e){if(xe(!ge),ge){var t=H.map((function(e){return e.id})),n=C.filter((function(e){return!t.includes(e)}));y(n)}else{var l=H.filter((function(e){return!C.includes(e.id)})).map((function(e){return e.id})),i=[].concat((0,a.Z)(C),(0,a.Z)(l));y(i)}},onSelectOneChange:function(e){var t=e.target,n=t.id,l=t.checked?[].concat((0,a.Z)(C),[n]):C.filter((function(e){return e!==n})),i=H.filter((function(e){return l.includes(e.id)})).length===H.length;xe(i),y(l)},onNextPageClick:function(e){F.set("page",String(Q+1)),M(F)},onPrevPageClick:function(e){F.set("page",String(Q-1)),M(F)},onSelectedItemsClearClick:function(e){(0,v.h7)("unselect-modal")}})]})}}}]);
//# sourceMappingURL=118.e71d6611.chunk.js.map
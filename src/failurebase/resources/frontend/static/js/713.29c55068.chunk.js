"use strict";(self.webpackChunkfailurebase_client=self.webpackChunkfailurebase_client||[]).push([[713],{8030:function(e,t,n){n.d(t,{Z:function(){return r}});n(2791);var l=n.p+"static/media/close.1bc230665c2ece0f1a76c0af957f07ec.svg",i=n(184),r=function(e){var t=e.text,n=e.id,r=e.className,s=e.onClose;return(0,i.jsxs)("span",{id:n,className:"info-badge "+(null!==r&&void 0!==r?r:""),children:[t,(0,i.jsx)("img",{className:"info-badge-close",src:l,alt:"Close SVG",onClick:function(e){s(e)}})]})}},2582:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var l=n(4942),i=n(1413),r=n(4925),s=n(9142),a=n(3433),o=n(9439),c=n(2791),d=n(7689),u=n(1087),f=n(4447),h=n(3223),m=n(7940),p=n(8390),x=n(1944),v=n(5687),j=n(8430),g=n(5265),Z=n(9489),k=n(9141),b=n(9672),C=n(4165),S=n(5861),y=n(5301),N=function(){var e=(0,S.Z)((0,C.Z)().mark((function e(t){return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Z)("/api/tests",t.toString());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,S.Z)((0,C.Z)().mark((function e(t,n){var l;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={method:"POST",body:JSON.stringify({ids:t}),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8","Api-Key":n}},e.next=3,(0,y.Z)("/api/tests/delete","",l);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_={getAll:N,deleteGiven:D},A=n(2278),w=n(8030),T=n(9925),P=n(1733),I=n(184),M=[{id:"uid-collumn",label:"UID",order:p.K.ASC},{id:"file-collumn",label:"File",order:p.K.DESC},{id:"total-events-count-collumn",label:"Events Count",order:p.K.ASC},{id:"marks-collumn",label:"Marks",order:p.K.NULL}],E=function(){var e,t=(0,d.s0)(),n=(0,m.$)(),C=n.setLoading,S=n.selectedTests,y=n.setSelectedTests,N=(0,u.lr)(),D=(0,o.Z)(N,2),E=D[0],F=D[1],K=(0,c.useState)({}),O=(0,o.Z)(K,2),U=O[0],G=O[1],q=(0,c.useState)(0),V=(0,o.Z)(q,2),$=V[0],L=V[1],B=(0,c.useState)([]),J=(0,o.Z)(B,2),R=J[0],z=J[1],H=(0,c.useState)(0),Q=(0,o.Z)(H,2),W=Q[0],X=Q[1],Y=(0,c.useState)(!1),ee=(0,o.Z)(Y,2),te=ee[0],ne=ee[1],le=(0,c.useState)(!1),ie=(0,o.Z)(le,2),re=ie[0],se=ie[1],ae=(0,c.useState)(0),oe=(0,o.Z)(ae,2),ce=oe[0],de=oe[1],ue=(0,c.useState)(0),fe=(0,o.Z)(ue,2),he=fe[0],me=fe[1],pe=(0,c.useState)(!1),xe=(0,o.Z)(pe,2),ve=xe[0],je=xe[1],ge=(0,c.useState)(),Ze=(0,o.Z)(ge,2),ke=Ze[0],be=Ze[1],Ce=(0,c.useState)(),Se=(0,o.Z)(Ce,2),ye=Se[0],Ne=Se[1],De=(0,c.useState)(""),_e=(0,o.Z)(De,2),Ae=_e[0],we=_e[1],Te=function(){C(!0),_.getAll(E).then((function(e){var t=e.items.map((function(e){return function(e){return{id:e.id.toString(),data:[{id:"uid",label:(0,P.Dy)(e.uid,100),onClick:function(){Ne(e),(0,j.h7)("detail-modal")}},{id:"file",label:(0,P.Dy)(e.file,100)},{id:"total_events_count",label:e.total_events_count.toString()},{id:"test-marks",label:e.marks.join(", ")}]}}(e)})),n=document.querySelectorAll("#filter-modal input"),l={};n.forEach((function(e){var t,n=null!==(t=e.id.split("-").slice(1,-1).join("_"))&&void 0!==t?t:"",i=E.getAll(n);i.length>0&&(n.includes("timestamp")?l[n]=(0,P.d$)(new Date(i[0])):n.includes("mark")?l.marks=i:l[n]=i[0])}));var i=0!==S.length&&t.filter((function(e){return S.includes(e.id)})).length===t.length;z(t),X(e.page_number),se(e.prev_page),ne(e.next_page),de(e.count),me(e.page_limit),je(i),G(l),C(!1)})).catch((function(e){console.log(e),C(!1)}))};(0,c.useEffect)(Te,[window.location.href]),(0,c.useEffect)((function(){L(Object.keys(U).length)}),[U]);var Pe=function(e){var t=e.target.id.split("-").slice(1,-1).join("_"),n=t.includes("timestamp")?(0,P.d$)(new Date(e.target.value)):e.target.value;if(""===e.target.value&&t in U){U[t];var a=(0,r.Z)(U,[t].map(s.Z));G(a)}else G((0,i.Z)((0,i.Z)({},U),{},(0,l.Z)({},t,n)))},Ie=function(e){if("marks"in U){var t=(0,i.Z)({},U);t.marks=U.marks.filter((function(t){var n;return t!==(null===(n=e.currentTarget.parentNode)||void 0===n?void 0:n.textContent)})),G(t)}};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"filters",children:[(0,I.jsx)("div",{className:"row",children:(0,I.jsxs)("div",{className:"col filter-button",children:[(0,I.jsx)("span",{className:"brand",children:"Tests"}),(0,I.jsxs)(x.Z,{onClick:function(e){(0,j.h7)("filter-modal"),document.querySelectorAll("#filter-modal input").forEach((function(e){var t,n=null!==(t=E.get(e.id.split("-").slice(1,-1).join("_")))&&void 0!==t?t:"";""!==n&&(e.id.includes("timestamp")?e.value=(0,P.d$)(new Date(n)):e.id.includes("mark")?e.value="":e.value=n)}))},children:[(0,I.jsx)("img",{src:f.Z,alt:"Filter SVG"}),$>0&&(0,I.jsx)(v.Z,{text:$})]}),(0,I.jsx)(x.Z,{onClick:function(e){(0,j.h7)("delete-modal")},children:(0,I.jsx)("img",{src:h.Z,alt:"Delete SVG"})})]})}),(0,I.jsxs)(j.ZP,{id:"filter-modal",children:[(0,I.jsx)(g.Z,{children:(0,I.jsx)("span",{className:"text-primary",children:"Filter tests"})}),(0,I.jsxs)(Z.Z,{children:[(0,I.jsxs)("p",{children:[(0,I.jsx)("label",{htmlFor:"filter-uid-input",children:"UID"}),(0,I.jsx)("input",{id:"filter-uid-input",type:"text",placeholder:"Type phrase to search",onChange:Pe})]}),(0,I.jsxs)("p",{children:[(0,I.jsx)("label",{htmlFor:"filter-file-input",children:"File"}),(0,I.jsx)("input",{id:"filter-file-input",type:"text",placeholder:"Type phrase to search",onChange:Pe})]}),(0,I.jsxs)("p",{children:[(0,I.jsx)("label",{htmlFor:"filter-mark-input",children:"Mark"}),(0,I.jsxs)("span",{className:"grouped",children:[(0,I.jsx)("input",{id:"filter-mark-input",type:"text",placeholder:"Type mark to search"}),(0,I.jsx)("button",{id:"addMark",className:"button",onClick:function(e){var t=document.querySelector("#filter-mark-input");if(null!==t){var n,l=(0,i.Z)({},U);if(""!==t.value&&(void 0===l.marks||-1===l.marks.indexOf(t.value)))l.marks=[].concat((0,a.Z)(null!==(n=l.marks)&&void 0!==n?n:[]),[t.value]);t.value="",G(l)}},children:"Add"})]}),(0,I.jsx)("span",{children:null===U||void 0===U||null===(e=U.marks)||void 0===e?void 0:e.map((function(e,t){return(0,I.jsx)(w.Z,{text:e,onClose:Ie},t)}))})]})]}),(0,I.jsxs)(k.Z,{children:[(0,I.jsx)("button",{className:"button primary",onClick:function(e){for(var t=0,n=Object.entries(U);t<n.length;t++){var l=(0,o.Z)(n[t],2),i=l[0],r=l[1];if("marks"===i){E.delete("mark");for(var s=0;s<r.length;s++)E.append("mark",String(r[s]))}else E.set(i,String(r))}E.delete("page"),F(E),y([]),je(!1),(0,j.Mr)("filter-modal")},children:"Submit"}),(0,I.jsx)("button",{className:"button",onClick:function(e){document.querySelectorAll("#filter-modal input").forEach((function(e){e.value="",E.delete(e.id.split("-").slice(1,-1).join("_"))})),G({}),F(E)},children:"Clear"}),(0,I.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("filter-modal")},children:"Close"})]})]}),(0,I.jsxs)(j.ZP,{id:"delete-modal",children:[(0,I.jsx)(g.Z,{children:(0,I.jsx)("span",{className:"text-primary",children:"Delete tests"})}),(0,I.jsxs)(Z.Z,{children:[function(){if(0===S.length)return(0,I.jsx)("strong",{children:"No tests selected to deletion."});var e=S.length>1?"s":"";return(0,I.jsxs)("strong",{children:[S.length," test",e," selected to deletion. "]})}(),(0,I.jsx)(T.Z,{id:"api-key-delete-modal",labelClassName:"",inputClassName:"",labelText:"API Key",inputValue:Ae,onInputChange:function(e){we(e.target.value)}}),(0,I.jsxs)(b.ZP,{id:"deletion-in-progress",children:[(0,I.jsx)("div",{style:{marginBottom:"10px"},children:(0,I.jsx)("span",{children:"Deleting..."})}),(0,I.jsx)(A.Z,{})]}),(0,I.jsxs)(b.ZP,{id:"deletion-done",children:[(0,I.jsx)("span",{className:"text-primary",children:"Result:"}),(0,I.jsx)("br",{}),(0,I.jsx)("span",{children:ke})]})]}),(0,I.jsxs)(k.Z,{children:[(0,I.jsx)("button",{className:"button primary",onClick:function(e){0!==S.length&&((0,b.Kc)("deletion-in-progress"),(0,b.Ov)("deletion-done"),_.deleteGiven(S,Ae).then((function(e){var t=(0,P.TI)(e);be(t),setTimeout((function(){y([]),(0,b.Ov)("deletion-in-progress"),(0,b.Kc)("deletion-done")}),1e3)})).catch((function(e){var t,n;be((0,I.jsx)("p",{className:"text-error",children:"Deletion error"})),setTimeout((function(){(0,b.Ov)("deletion-in-progress"),(0,b.Kc)("deletion-done")}),1e3),console.error("Error details: ".concat(String(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.detail)&&void 0!==t?t:"no details ")))})))},disabled:""===Ae,children:"Confirm"}),(0,I.jsx)("button",{className:"button",onClick:function(e){be(""),we(""),(0,b.Ov)("deletion-done"),(0,j.Mr)("delete-modal"),""!==ke&&Te()},children:"Close"})]})]}),(0,I.jsxs)(j.ZP,{id:"unselect-modal",children:[(0,I.jsx)(g.Z,{children:"Unselect items"}),(0,I.jsx)(Z.Z,{children:"Do you confirm unselection of all items?"}),(0,I.jsxs)(k.Z,{children:[(0,I.jsx)("button",{className:"button primary",onClick:function(e){je(!1),y([]),(0,j.Mr)("unselect-modal")},children:"Confirm"}),(0,I.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("unselect-modal")},children:"Close"})]})]}),(0,I.jsxs)(j.ZP,{id:"detail-modal",children:[(0,I.jsx)(g.Z,{children:(0,I.jsx)("span",{className:"text-primary",children:"Details"})}),(0,I.jsxs)(Z.Z,{id:"detail-modal-body",children:[(0,I.jsx)("strong",{children:"UID:"}),(0,I.jsx)("p",{children:null===ye||void 0===ye?void 0:ye.uid}),(0,I.jsx)("strong",{children:"File:"}),(0,I.jsx)("p",{children:null===ye||void 0===ye?void 0:ye.file}),(0,I.jsx)("strong",{children:"Events count:"}),(0,I.jsx)("p",{children:null===ye||void 0===ye?void 0:ye.total_events_count}),(0,I.jsx)("strong",{children:"Marks:"}),(0,I.jsx)("p",{children:null===ye||void 0===ye?void 0:ye.marks.join(", ")})]}),(0,I.jsx)(k.Z,{children:(0,I.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("detail-modal")},children:"Close"})})]})]}),(0,I.jsx)(p.Z,{header:M,data:R,selectedItemsInfo:0===S.length?"":1===S.length?"1 row selected":"".concat(S.length," rows selected"),pageInfo:"page ".concat(W+1," of ").concat(0!==ce?Math.ceil(ce/he):1),secectedItems:S,selectAllChecked:ve,prevPageDisabled:!re,nextPageDisabled:!te,onSortClick:function(e,n){var l=e.replace("-collumn","").replaceAll("-","_"),i="".concat(n===p.K.DESC?"-":"").concat(l);E.set("ordering",i),F(E),t({pathname:"/tests",search:"?"+String(E)})},onSelectAllChange:function(e){if(je(!ve),ve){var t=R.map((function(e){return e.id})),n=S.filter((function(e){return!t.includes(e)}));y(n)}else{var l=R.filter((function(e){return!S.includes(e.id)})).map((function(e){return e.id})),i=[].concat((0,a.Z)(S),(0,a.Z)(l));y(i)}},onSelectOneChange:function(e){var t=e.target,n=t.id,l=t.checked?[].concat((0,a.Z)(S),[n]):S.filter((function(e){return e!==n})),i=R.filter((function(e){return l.includes(e.id)})).length===R.length;je(i),y(l)},onNextPageClick:function(e){E.set("page",String(W+1)),F(E)},onPrevPageClick:function(e){E.set("page",String(W-1)),F(E)},onSelectedItemsClearClick:function(e){(0,j.h7)("unselect-modal")}})]})}}}]);
//# sourceMappingURL=713.29c55068.chunk.js.map
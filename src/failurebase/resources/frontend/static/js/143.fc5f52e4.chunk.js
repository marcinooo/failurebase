"use strict";(self.webpackChunkfailurebase_client=self.webpackChunkfailurebase_client||[]).push([[143],{8030:function(e,t,n){n.d(t,{Z:function(){return s}});n(2791);var l=n.p+"static/media/close.1bc230665c2ece0f1a76c0af957f07ec.svg",i=n(184),s=function(e){var t=e.text,n=e.id,s=e.className,r=e.onClose;return(0,i.jsxs)("span",{id:n,className:"info-badge "+(null!==s&&void 0!==s?s:""),children:[t,(0,i.jsx)("img",{className:"info-badge-close",src:l,alt:"Close SVG",onClick:function(e){r(e)}})]})}},9406:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var l=n(4942),i=n(1413),s=n(4925),r=n(9142),a=n(3433),c=n(9439),o=n(2791),d=n(7689),u=n(1087),m=n(4447),p=n(3223),h=n(7940),f=n(8390),x=n(1944),v=n(5687),j=n(8430),g=n(5265),Z=n(9489),b=n(9141),k=n(9672),C=n(4165),S=n(5861),y=n(5301),N=function(){var e=(0,S.Z)((0,C.Z)().mark((function e(t){return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Z)("/api/events",t.toString());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,S.Z)((0,C.Z)().mark((function e(t,n){var l;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={method:"POST",body:JSON.stringify({ids:t}),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8","Api-Key":n}},e.next=3,(0,y.Z)("/api/events/delete","",l);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D={getAll:N,deleteGiven:T},_=n(2278),A=n(8030),w=n(9925),E=n(1733),P=n(184),M=[{id:"message-collumn",label:"Message",order:f.K.ASC},{id:"server-timestamp-collumn",label:"Server timestamp",order:f.K.DESC},{id:"client-timestamp-collumn",label:"Client timestamp",order:f.K.ASC},{id:"test-uid-collumn",label:"Test UID",order:f.K.ASC},{id:"test-marks-collumn",label:"Test marks",order:f.K.NULL}],F=function(){var e,t,n,C=(0,d.s0)(),S=(0,h.$)(),y=S.setLoading,N=S.selectedEvents,T=S.setSelectedEvents,F=(0,u.lr)(),I=(0,c.Z)(F,2),K=I[0],O=I[1],U=(0,o.useState)({}),G=(0,c.Z)(U,2),q=G[0],V=G[1],$=(0,o.useState)(0),L=(0,c.Z)($,2),B=L[0],J=L[1],R=(0,o.useState)([]),z=(0,c.Z)(R,2),H=z[0],Q=z[1],W=(0,o.useState)(0),X=(0,c.Z)(W,2),Y=X[0],ee=X[1],te=(0,o.useState)(!1),ne=(0,c.Z)(te,2),le=ne[0],ie=ne[1],se=(0,o.useState)(!1),re=(0,c.Z)(se,2),ae=re[0],ce=re[1],oe=(0,o.useState)(0),de=(0,c.Z)(oe,2),ue=de[0],me=de[1],pe=(0,o.useState)(0),he=(0,c.Z)(pe,2),fe=he[0],xe=he[1],ve=(0,o.useState)(!1),je=(0,c.Z)(ve,2),ge=je[0],Ze=je[1],be=(0,o.useState)(),ke=(0,c.Z)(be,2),Ce=ke[0],Se=ke[1],ye=(0,o.useState)(),Ne=(0,c.Z)(ye,2),Te=Ne[0],De=Ne[1],_e=(0,o.useState)(""),Ae=(0,c.Z)(_e,2),we=Ae[0],Ee=Ae[1],Pe=function(){y(!0),D.getAll(K).then((function(e){var t=e.items.map((function(e){return function(e){return{id:e.id.toString(),data:[{id:"message",label:(0,E.Dy)(e.message,100),onClick:function(){De(e),(0,j.h7)("detail-modal")}},{id:"server-timestamp",label:e.server_timestamp.replace("T","  ")},{id:"client-timestamp",label:e.client_timestamp.replace("T","  ")},{id:"test-uid",label:(0,E.Dy)(e.test.uid,40)},{id:"test-marks",label:e.test.marks.join(", ")}]}}(e)})),n=document.querySelectorAll("#filter-modal input"),l={};n.forEach((function(e){var t,n=null!==(t=e.id.split("-").slice(1,-1).join("_"))&&void 0!==t?t:"",i=K.getAll(n);i.length>0&&(n.includes("timestamp")?l[n]=(0,E.d$)(new Date(i[0])):n.includes("mark")?l.marks=i:l[n]=i[0])}));var i=0!==N.length&&t.filter((function(e){return N.includes(e.id)})).length===t.length;Q(t),ee(e.page_number),ce(e.prev_page),ie(e.next_page),me(e.count),xe(e.page_limit),Ze(i),V(l),y(!1)})).catch((function(e){console.log(e),y(!1)}))};(0,o.useEffect)(Pe,[window.location.href]),(0,o.useEffect)((function(){J(Object.keys(q).length)}),[q]);var Me=function(e){var t=e.target.id.split("-").slice(1,-1).join("_"),n=t.includes("timestamp")?(0,E.d$)(new Date(e.target.value)):e.target.value;if(""===e.target.value&&t in q){q[t];var a=(0,s.Z)(q,[t].map(r.Z));V(a)}else V((0,i.Z)((0,i.Z)({},q),{},(0,l.Z)({},t,n)))},Fe=function(e){if("marks"in q){var t=(0,i.Z)({},q);t.marks=q.marks.filter((function(t){var n;return t!==(null===(n=e.currentTarget.parentNode)||void 0===n?void 0:n.textContent)})),V(t)}};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:"filters",children:[(0,P.jsx)("div",{className:"row",children:(0,P.jsxs)("div",{className:"col filter-button",children:[(0,P.jsx)("span",{className:"brand",children:"Events"}),(0,P.jsxs)(x.Z,{onClick:function(e){(0,j.h7)("filter-modal"),document.querySelectorAll("#filter-modal input").forEach((function(e){var t,n=null!==(t=K.get(e.id.split("-").slice(1,-1).join("_")))&&void 0!==t?t:"";""!==n&&(e.id.includes("timestamp")?e.value=(0,E.d$)(new Date(n)):e.id.includes("mark")?e.value="":e.value=n)}))},children:[(0,P.jsx)("img",{src:m.Z,alt:"Filter SVG"}),B>0&&(0,P.jsx)(v.Z,{text:B})]}),(0,P.jsx)(x.Z,{onClick:function(e){(0,j.h7)("delete-modal")},children:(0,P.jsx)("img",{src:p.Z,alt:"Delete SVG"})})]})}),(0,P.jsxs)(j.ZP,{id:"filter-modal",children:[(0,P.jsx)(g.Z,{children:(0,P.jsx)("span",{className:"text-primary",children:"Filter events"})}),(0,P.jsxs)(Z.Z,{children:[(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-message-input",children:"Message"}),(0,P.jsx)("input",{id:"filter-message-input",type:"text",placeholder:"Type phrase to search",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-start-server-timestamp-input",children:"Start server timestamp"}),(0,P.jsx)("input",{id:"filter-start-server-timestamp-input",type:"datetime-local",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-end-server-timestamp-input",children:"End end timestamp"}),(0,P.jsx)("input",{id:"filter-end-server-timestamp-input",type:"datetime-local",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-start-client-timestamp-input",children:"Start client timestamp"}),(0,P.jsx)("input",{id:"filter-start-client-timestamp-input",type:"datetime-local",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-end-client-timestamp-input",children:"End client timestamp"}),(0,P.jsx)("input",{id:"filter-end-client-timestamp-input",type:"datetime-local",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-test-uid-input",children:"Test UID"}),(0,P.jsx)("input",{id:"filter-test-uid-input",type:"text",placeholder:"Type phrase to search",onChange:Me})]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("label",{htmlFor:"filter-mark-input",children:"Mark"}),(0,P.jsxs)("span",{className:"grouped",children:[(0,P.jsx)("input",{id:"filter-test-mark-input",type:"text",placeholder:"Type mark to search"}),(0,P.jsx)("button",{id:"addMark",className:"button",onClick:function(e){var t=document.querySelector("#filter-test-mark-input");if(null!==t){var n,l=(0,i.Z)({},q);if(""!==t.value&&(void 0===l.marks||-1===l.marks.indexOf(t.value)))l.marks=[].concat((0,a.Z)(null!==(n=l.marks)&&void 0!==n?n:[]),[t.value]);t.value="",V(l)}},children:"Add"})]}),(0,P.jsx)("span",{children:null===q||void 0===q||null===(e=q.marks)||void 0===e?void 0:e.map((function(e,t){return(0,P.jsx)(A.Z,{text:e,onClose:Fe},t)}))})]})]}),(0,P.jsxs)(b.Z,{children:[(0,P.jsx)("button",{className:"button primary",onClick:function(e){for(var t=0,n=Object.entries(q);t<n.length;t++){var l=(0,c.Z)(n[t],2),i=l[0],s=l[1];if("marks"===i){K.delete("test_mark");for(var r=0;r<s.length;r++)K.append("test_mark",String(s[r]))}else K.set(i,String(s))}K.delete("page"),O(K),T([]),Ze(!1),(0,j.Mr)("filter-modal")},children:"Submit"}),(0,P.jsx)("button",{className:"button",onClick:function(e){document.querySelectorAll("#filter-modal input").forEach((function(e){e.value="",K.delete(e.id.split("-").slice(1,-1).join("_"))})),V({}),O(K)},children:"Clear"}),(0,P.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("filter-modal")},children:"Close"})]})]}),(0,P.jsxs)(j.ZP,{id:"delete-modal",children:[(0,P.jsx)(g.Z,{children:(0,P.jsx)("span",{className:"text-primary",children:"Delete events"})}),(0,P.jsxs)(Z.Z,{children:[function(){if(0===N.length)return(0,P.jsx)("strong",{children:"No event selected to deletion."});var e=N.length>1?"s":"";return(0,P.jsxs)("strong",{children:[N.length," event",e," selected to deletion. "]})}(),(0,P.jsx)(w.Z,{id:"api-key-delete-modal",labelClassName:"",inputClassName:"",labelText:"API Key",inputValue:we,onInputChange:function(e){Ee(e.target.value)}}),(0,P.jsxs)(k.ZP,{id:"deletion-in-progress",children:[(0,P.jsx)("div",{style:{marginBottom:"10px"},children:(0,P.jsx)("span",{children:"Deleting..."})}),(0,P.jsx)(_.Z,{})]}),(0,P.jsxs)(k.ZP,{id:"deletion-done",children:[(0,P.jsx)("span",{className:"text-primary",children:"Result:"}),(0,P.jsx)("br",{}),(0,P.jsx)("span",{children:Ce})]})]}),(0,P.jsxs)(b.Z,{children:[(0,P.jsx)("button",{className:"button primary",onClick:function(e){0!==N.length&&((0,k.Kc)("deletion-in-progress"),(0,k.Ov)("deletion-done"),D.deleteGiven(N,we).then((function(e){var t=(0,E.TI)(e);Se(t),setTimeout((function(){T([]),(0,k.Ov)("deletion-in-progress"),(0,k.Kc)("deletion-done")}),1e3)})).catch((function(e){var t,n;Se((0,P.jsx)("p",{className:"text-error",children:"Deletion error"})),setTimeout((function(){(0,k.Ov)("deletion-in-progress"),(0,k.Kc)("deletion-done")}),1e3),console.error("Error details: ".concat(String(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.detail)&&void 0!==t?t:"no details ")))})))},disabled:""===we,children:"Confirm"}),(0,P.jsx)("button",{className:"button",onClick:function(e){Se(""),Ee(""),(0,k.Ov)("deletion-done"),(0,j.Mr)("delete-modal"),console.log(N),""!==Ce&&Pe()},children:"Close"})]})]}),(0,P.jsxs)(j.ZP,{id:"unselect-modal",children:[(0,P.jsx)(g.Z,{children:(0,P.jsx)("span",{className:"text-primary",children:"Unselect items"})}),(0,P.jsx)(Z.Z,{children:"Do you confirm unselection of all items?"}),(0,P.jsxs)(b.Z,{children:[(0,P.jsx)("button",{className:"button primary",onClick:function(e){Ze(!1),T([]),(0,j.Mr)("unselect-modal")},children:"Confirm"}),(0,P.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("unselect-modal")},children:"Close"})]})]}),(0,P.jsxs)(j.ZP,{id:"detail-modal",children:[(0,P.jsx)(g.Z,{children:(0,P.jsx)("span",{className:"text-primary",children:"Details"})}),(0,P.jsxs)(Z.Z,{id:"detail-modal-body",children:[(0,P.jsx)("strong",{children:"Message:"}),(0,P.jsx)("pre",{className:"event-code",children:null===Te||void 0===Te?void 0:Te.message}),(0,P.jsx)("strong",{children:"Server timestamp:"}),(0,P.jsx)("p",{children:null===Te||void 0===Te?void 0:Te.server_timestamp.replace("T","  ")}),(0,P.jsx)("strong",{children:"Client timestamp:"}),(0,P.jsx)("p",{children:null===Te||void 0===Te?void 0:Te.client_timestamp.replace("T","  ")}),(0,P.jsx)("strong",{children:"Test UID:"}),(0,P.jsx)("p",{children:null===Te||void 0===Te||null===(t=Te.test)||void 0===t?void 0:t.uid}),(0,P.jsx)("strong",{children:"Test file:"}),(0,P.jsx)("p",{children:null===Te||void 0===Te||null===(n=Te.test)||void 0===n?void 0:n.file}),(0,P.jsx)("strong",{children:"Test marks:"}),(0,P.jsx)("p",{children:null===Te||void 0===Te?void 0:Te.test.marks.join(", ")}),(0,P.jsx)("strong",{children:"Traceback:"}),(0,P.jsx)("pre",{className:"event-code",children:null===Te||void 0===Te?void 0:Te.traceback})]}),(0,P.jsx)(b.Z,{children:(0,P.jsx)("button",{className:"button",onClick:function(e){(0,j.Mr)("detail-modal")},children:"Close"})})]})]}),(0,P.jsx)(f.Z,{header:M,data:H,selectedItemsInfo:0===N.length?"":1===N.length?"1 row selected":"".concat(N.length," rows selected"),pageInfo:"page ".concat(Y+1," of ").concat(0!==ue?Math.ceil(ue/fe):1),secectedItems:N,selectAllChecked:ge,prevPageDisabled:!ae,nextPageDisabled:!le,onSortClick:function(e,t){var n=e.replace("-collumn","").replaceAll("-","_"),l="".concat(t===f.K.DESC?"-":"").concat(n);K.set("ordering",l),O(K),C({pathname:"/events",search:"?"+String(K)})},onSelectAllChange:function(e){if(Ze(!ge),ge){var t=H.map((function(e){return e.id})),n=N.filter((function(e){return!t.includes(e)}));T(n)}else{var l=H.filter((function(e){return!N.includes(e.id)})).map((function(e){return e.id})),i=[].concat((0,a.Z)(N),(0,a.Z)(l));T(i)}},onSelectOneChange:function(e){var t=e.target,n=t.id,l=t.checked?[].concat((0,a.Z)(N),[n]):N.filter((function(e){return e!==n})),i=H.filter((function(e){return l.includes(e.id)})).length===H.length;Ze(i),T(l)},onNextPageClick:function(e){K.set("page",String(Y+1)),O(K)},onPrevPageClick:function(e){K.set("page",String(Y-1)),O(K)},onSelectedItemsClearClick:function(e){(0,j.h7)("unselect-modal")}})]})}}}]);
//# sourceMappingURL=143.fc5f52e4.chunk.js.map